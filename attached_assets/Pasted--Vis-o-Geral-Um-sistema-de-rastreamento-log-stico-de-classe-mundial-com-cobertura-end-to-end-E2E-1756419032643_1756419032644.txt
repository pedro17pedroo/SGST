# Visão Geral

Um sistema de rastreamento logístico de classe mundial, com cobertura end‑to‑end (E2E) desde o recebimento até a prova de entrega (POD), orientado por padrões (ISO 27001/27701, GS1, WMS/ TMS best practices), com arquitetura resiliente, offline‑first e extensível. Este blueprint foi desenhado para *superar* os melhores do mercado, oferecendo recursos adicionais de IA, IoT, *triple‑ledger traceability* (blockchain opcional), digital twin operacional e UX centrada no operador.

---

## Objetivos Estratégicos

 1.⁠ ⁠*Rastreabilidade total*: item‑level (lote/SN), unidade logística (SKU, caixa, palete) e carga (contentor/carreta).
 2.⁠ ⁠*Precisão de inventário ≥ 99,8%* e *OTIF ≥ 98%* com visibilidade em tempo real.
 3.⁠ ⁠*Ciclo de picking 10–30% mais rápido* com menos erros (< 0,1%).
 4.⁠ ⁠*ETA preditivo com erro médio < 7 minutos* em zonas urbanas.
 5.⁠ ⁠*Segurança by design*: conformidade com ISO 27001 e privacidade por padrão (DPIA/27701).
 6.⁠ ⁠*Operação em ambientes com conectividade limitada* (ex.: zonas de Angola) com sincronização confiável.

---

## Escopo Funcional (Módulos)

### 1) Master Data & Configurações

•⁠  ⁠Catálogo de produtos (SKU), UOM, kits/BOM, atributos GS1 (GTIN, SSCC), lotes e série.
•⁠  ⁠Locais: armazéns/micro‑hubs, zonas, corredores, prateleiras, posições (bin/slot), endereçamento inteligente.
•⁠  ⁠Parceiros: fornecedores, transportadoras, motoristas, clientes, SLAs.
•⁠  ⁠Regras de negócio: políticas de picking, reabastecimento, putaway, ciclos de contagem, ondas, agendamento docas.

### 2) Recebimento & Putaway

•⁠  ⁠ASN/EDI/API/Portal fornecedor.
•⁠  ⁠Identificação: QR/Barcode (1D/2D), RFID/UWB, visão computacional (CV) para contagem.
•⁠  ⁠Qualidade: inspeção, amostragem, quarentena, fotos e notas.
•⁠  ⁠Putaway guiado por regras (slotting dinâmico), cross‑dock, criação de palete SSCC.

### 3) Gestão de Stocks (WMS core)

•⁠  ⁠Inventário em tempo real por localização/lote/SN.
•⁠  ⁠Reabastecimento automático (min/max, demanda preditiva).
•⁠  ⁠Contagem cíclica por risco/valor/rotatividade; dupla conferência por CV/RFID.
•⁠  ⁠Transferências internas, ajustes auditáveis (SOX‑like), valuation FIFO/FEFO/LEFO por lote.

### 4) Planeamento & Execução de Picking

•⁠  ⁠Estratégias: single, batch, cluster, zone, wave, waveless.
•⁠  ⁠Otimização de rotas de picking por grafo do armazém.
•⁠  ⁠Dispositivos: handhelds Android, wearables (ring scanners), voice picking (PT/EN), AR (óculos) para highlights.
•⁠  ⁠Verificação dupla: scan‑scan (local + item), balanças integradas, smart‑carts (UWB/RTLS).

### 5) Embalagem, Consolidação e Expedição

•⁠  ⁠Packing UI com validação de peso/volume.
•⁠  ⁠Etiquetas GS1‑128/QR, manifesto, booking de doca, selos digitais.
•⁠  ⁠Dangerous goods, cold‑chain, documentação aduaneira.

### 6) TMS & Monitoramento de Entregas

•⁠  ⁠Planeamento de rotas (VRP) com janelas de tempo, restrições de veículo.
•⁠  ⁠*ETA preditivo* (ML + tráfego + histórico + clima).
•⁠  ⁠Aplicativo do motorista: navegação, paradas, provas de entrega (assinatura, foto, OCR documento, e‑seal), chat seguro.
•⁠  ⁠Geofencing, alertas (atraso, desvio, violações de temperatura), re‑planeamento automático.

### 7) Devoluções (Reverse Logistics)

•⁠  ⁠Workflow de RMA, triagem (re‑estocagem/refabricação/descartes), recolha programada.

### 8) Torre de Controlo (Command Center)

•⁠  ⁠Painéis em tempo real (WMS/TMS/OMS), heatmaps, *digital twin* do armazém e da frota.
•⁠  ⁠What‑if/Simulação (picos, falta de mão‑de‑obra, avarias).

### 9) Integrações & EDI

•⁠  ⁠ERP (financeiro/ordens), OMS, e‑commerce, marketplaces, transportadoras, EMIS/Unitel Money para cobranças na entrega (opcional).
•⁠  ⁠APIs REST/GraphQL, Webhooks, EDI (EDIFACT/X12), AS2/SFTP.

### 10) Administração, Auditoria e Compliance

•⁠  ⁠Gestão de utilizadores/roles, segredos/PKI, trilhas de auditoria imutáveis.
•⁠  ⁠Conformidade ISO 27001/27701, LGPD/GDPR‑like, retenção e expurgo.

---

## Diferenciadores 10x (além dos melhores)

 1.⁠ ⁠*Offline‑first total*: apps de chão‑de‑fábrica e motorista operam 100% offline com CRDTs e fila de sincronização.
 2.⁠ ⁠*Computer Vision Edge*: contagem automática em recebimento e conferência no packing, detecção de danos.
 3.⁠ ⁠*RTLS híbrido*: RFID + UWB + BLE para precisão < 30 cm em zonas críticas; geofencing indoor/outdoor.
 4.⁠ ⁠*Digital Twin Operacional*: visual 3D/2D do armazém, simulação de picking/putaway, previsões de backlog.
 5.⁠ ⁠*Anomalia & Fraude*: ML que detecta eventos incoerentes (saltos de localização, leituras fora de janela, manipulação de etiqueta).
 6.⁠ ⁠*Triple‑Ledger Traceability*: trilhas internas (DB), assinaturas (WORM storage) e hash em blockchain permissionada (opcional) para anti‑fraude.
 7.⁠ ⁠*Auto‑slotting*: otimização contínua de layout com base na rotatividade e afinidade de itens para reduzir percursos.
 8.⁠ ⁠*Green ETA*: otimiza rotas por custo e pegada de carbono; consolidação dinâmica.
 9.⁠ ⁠*UX hiper‑rápida*: < 200 ms de latência percebida; atalhos, “1‑tap confirm”.
10.⁠ ⁠*Operação em Angola*: tolerância a falhas de rede/energia, pacotes de mapas offline, fallback via SMS/USSD para POD básico.

---

## Arquitetura de Referência

*Estilo*: microserviços orientados a domínio (DDD), event‑driven, com CQRS + Event Sourcing onde crítico.

### Camadas

•⁠  ⁠*Edge/Clients*: Apps Android (WMS, Driver, Supervisor), Web (Ops/Admin), AR/Voice.
•⁠  ⁠*BFF (Backend for Frontend)*: GraphQL gateway + REST; agregação de dados por persona.
•⁠  ⁠*Serviços de Domínio*: ⁠ inventory ⁠, ⁠ receiving ⁠, ⁠ slotting ⁠, ⁠ picking ⁠, ⁠ packing ⁠, ⁠ shipping ⁠, ⁠ transport ⁠, ⁠ eta-ml ⁠, ⁠ alerts ⁠, ⁠ billing ⁠, ⁠ audit ⁠, ⁠ authz ⁠.
•⁠  ⁠*Plataforma de Dados*: Kafka/Pulsar (event bus), Data Lakehouse (Delta/Iceberg), Feature Store para ML, Redis (cache), Elastic/OpenSearch (busca & logs), Timeseries DB (IoT), WORM (S3‑Object Lock) para imutabilidade.
•⁠  ⁠*Integração*: iPaaS/ESB leve, conectores EDI/AS2, webhooks com assinatura HMAC.
•⁠  ⁠*Infra*: Kubernetes multi‑zona; edge nodes (no armazém) para CV/IoT; CDN para assets.

### Fluxos Críticos (resumo)

 1.⁠ ⁠*Recebimento*: ASN → scan/visão → valida qualidade → cria palete (SSCC) → putaway guiado → eventos ⁠ StockAdded ⁠.
 2.⁠ ⁠*Picking*: OMS/ERP → ondas → cálculo de caminho ótimo → confirmação com duplo scan + peso → ⁠ Picked ⁠ → packing → ⁠ Packed ⁠.
 3.⁠ ⁠*Expedição/Entrega*: consolidação → manifesto → carregamento com verificação de palete → saída (gate scan) → app motorista → geofencing → POD (assinatura/foto/OCR) → faturação.

---

## Modelo de Dados (alto nível)

•⁠  ⁠*Item*(sku, gtin, descrição, dimensões, peso, atributos, tags, lote, série)
•⁠  ⁠*Localização*(warehouse, zona, corredor, prateleira, bin, capacidade, temperatura)
•⁠  ⁠*Inventário*(item\_id, localização\_id, qte, lote, sn, status, owner)
•⁠  ⁠*Palete/Unidade Logística*(sscc, conteúdo, peso, volume, estado, lacre)
•⁠  ⁠*Ordem*(origem, destino, linhas, SLA, janela)
•⁠  ⁠*Tarefa*(tipo, prioridade, operador, estado, timestamps, evidências)
•⁠  ⁠*Viagem*(rota, veículo, motorista, paradas, ETA, telemetria)
•⁠  ⁠*Evento*(tipo, entidade, who/when/where, hash, assinatura)
•⁠  ⁠*POD*(assinatura, fotos, OCR doc, geotag, timestamp, checksum)

---

## UX & Dispositivos

•⁠  ⁠*Operador de Armazém*: handheld com botões grandes, vibração/áudio; voice picking; AR para highlight de prateleiras.
•⁠  ⁠*Conferente/Embalagem*: balança bluetooth; câmera com auto‑captura; tela de discrepâncias.
•⁠  ⁠*Motorista*: aplicativo com modo noturno, POD em 3 toques, controle de despesas, navegação offline.
•⁠  ⁠*Torre de Controlo*: dashboards com KPIs, mapas, filas de exceções, playbooks de resolução.

---

## IA/ML (produção)

•⁠  ⁠*ETA*: Gradient boosting/transformers + features de tráfego/clima/histórico.
•⁠  ⁠*Previsão de demanda & reabastecimento*: modelos sazonais + eventos promocionais.
•⁠  ⁠*Detecção de anomalias*: Isolation Forest/Autoencoders sobre eventos e telemetria.
•⁠  ⁠*Visão computacional*: contagem de caixas, leitura de etiquetas, danos, vedação.
•⁠  ⁠*Recomendador de slotting*: otimização combinatória (GRASP/ILS) + feedback humano.

---

## Segurança e Privacidade (ISO 27001/27701)

### Governança

•⁠  ⁠*ISMS* completo: escopo, SoA, política, avaliação de riscos, auditorias internas, melhoria contínua.
•⁠  ⁠*Papéis*: CISO, DPO, Owner de Ativo, Custodiante, Process Owners.

### Controles (mapa resumido a Anexo A:2022)

•⁠  ⁠*A.5* Políticas: políticas aprovadas e comunicadas.
•⁠  ⁠*A.6* Org. Segurança: responsabilidades, separação de funções.
•⁠  ⁠*A.8* Gestão de ativos: inventário, classificação, owners.
•⁠  ⁠*A.9* Controlo de Acesso: SSO/OIDC, MFA, RBAC/ABAC, PAM para admin, segredos em HSM/KMS.
•⁠  ⁠*A.10* Criptografia: TLS 1.3; AES‑GCM em repouso; chaves rotacionadas; assinatura digital (POD/eventos).
•⁠  ⁠*A.12* Operações seguras: hardening, backups imutáveis, anti‑malware, EDR/XDR, gestão de vulnerabilidades (CVSS), patching.
•⁠  ⁠*A.13* Segurança de comunicações: VPN/IPSec; assinatura de webhooks; DMZ.
•⁠  ⁠*A.14* Aquisição/desenvolvimento: SDLC seguro, SAST/DAST/SCA, IaC scanning, 4‑eyes review.
•⁠  ⁠*A.15* Rel. Fornecedores: due diligence, cláusulas de segurança, monitoramento.
•⁠  ⁠*A.16* Incidentes: CSIRT, playbooks, 24/7, exercícios, lições aprendidas.
•⁠  ⁠*A.17* Continuidade: BIA, RTO/RPO, DR em zona separada, tabletop/ failover tests.
•⁠  ⁠*A.18* Compliance: requisitos legais, DPIA, retenção/expurgo, logs não repudiáveis.

### Privacidade (27701)

•⁠  ⁠Minimização e pseudonimização; consentimento quando aplicável (ex. apps de motorista/cliente).
•⁠  ⁠Retenção por finalidade (ex.: POD 5–10 anos, telemetria 12–24 meses); anonimização para analytics.

---

## Conectividade & IoT

•⁠  ⁠Gateways edge com buffer store (MQTT), sincronização para cloud.
•⁠  ⁠Sensores: temperatura/umidade/choque, e‑seals, CAN‑bus/OBD‑II, câmeras com NVR local.
•⁠  ⁠UWB para RTLS indoor, BLE beacons, RFID (EPCglobal), GNSS multi‑banda.

---

## Métricas & KPIs (com metas)

•⁠  ⁠Precisão de inventário (≥ 99,8%)
•⁠  ⁠Taxa de erro de picking (≤ 0,1%)
•⁠  ⁠Tempo médio de ciclo de picking (‑20% YoY)
•⁠  ⁠OTIF (≥ 98%)
•⁠  ⁠Lead time de recebimento (‑25%)
•⁠  ⁠Ocupação de slots (%) e distância média por tarefa (‑15%)
•⁠  ⁠Cumprimento de ETA (MAPE < 12%)
•⁠  ⁠Taxa de devoluções por erro logístico (‑40%)
•⁠  ⁠MTTR incidentes críticos de TI (< 30 min)

---

## Relatórios & Dashboards

•⁠  ⁠*Painel Executivo*: OTIF, ETA vs real, backlog, custos por km/entrega, emissões.
•⁠  ⁠*WMS*: heatmap de falhas, rotas de picking, reabastecimento pendente, acurácia por zona.
•⁠  ⁠*TMS*: cumprimento de janelas, desvios e alertas, PODs pendentes.
•⁠  ⁠*Qualidade/Compliance*: CAPA, auditorias, trilhas blockchain/WORM.

---

## Integrações Prioritárias (Angola‑ready)

•⁠  ⁠ERPs comuns (SAP, Oracle, Microsoft, Primavera, PHC), OMS/e‑commerce.
•⁠  ⁠Pagamentos e CoD: EMIS/Multicaixa e Unitel Money (para cobranças na entrega).
•⁠  ⁠Mapas: mapas offline; integração com provedores locais de tráfego quando disponível.

---

## Roadmap de Implementação

*Fase 0 — Foundations (0–6 semanas)*

•⁠  ⁠ISMS inicial (políticas, SoA, risco), arquitetura, DevSecOps, CI/CD, observabilidade.
•⁠  ⁠MVP de inventário, recebimento, putaway, picking simples, app motorista com POD offline.

*Fase 1 — Performance & Visibilidade (6–16 semanas)*

•⁠  ⁠Otimização de picking, contagem cíclica, packing, TMS com rotas e ETA básico.
•⁠  ⁠Dashboards executivos, torre de controlo, integrações ERP/OMS.

*Fase 2 — 10x e IA (16–32 semanas)*

•⁠  ⁠CV no recebimento/packing, RTLS híbrido, ETA avançado, anomalia/fraude, auto‑slotting.
•⁠  ⁠Blockchain/WORM, digital twin, simulações.

*Fase 3 — Escala & Certificação (32–48 semanas)*

•⁠  ⁠DR ativo‑ativo, multi‑armazém/país, certificação ISO 27001/27701.

---

## SLOs/SLAs técnicos

•⁠  ⁠Disponibilidade serviço core: *99,95%* (cloud) / 99,9% (edge‑gateway)
•⁠  ⁠Latência BFF p95: *< 200 ms*
•⁠  ⁠Sincronização offline → online: *< 60 s* após rede restabelecida
•⁠  ⁠Entrega de eventos (at‑least‑once) p99: *< 5 s*

---

## Plano de Testes & Qualidade

•⁠  ⁠*Teste de unidade* (≥ 85% cobertura) e *contratos de API*.
•⁠  ⁠*Teste de performance* (picos Black Friday), *chaos testing* para tolerância a falhas.
•⁠  ⁠*UAT* com scripts por persona; *pilotos* em 1–2 armazéns e 1 região de entrega.
•⁠  ⁠Auditorias de segurança, pentests trimestrais, exercícios de DR.

---

## Riscos & Mitigações

•⁠  ⁠*Conectividade*: offline‑first, buffer de eventos, fallback SMS/USSD.
•⁠  ⁠*Adoção de operadores*: UX simplificada, formação, métricas de coaching.
•⁠  ⁠*Hardware*: plano de spares, MDM, contratos de manutenção.
•⁠  ⁠*Privacidade*: DPIA, minimização, políticas claras para motoristas/clientes.

---

## Requisitos Não‑Funcionais

•⁠  ⁠Escalabilidade horizontal, particionamento por tenant (multi‑tenant seguro).
•⁠  ⁠Observabilidade: logs estruturados, métricas (Prometheus), tracing (OpenTelemetry), SIEM.
•⁠  ⁠Resiliência: circuit breakers, retries, idempotência, backpressure.

---

## APIs (exemplos)

•⁠  ⁠⁠ POST /api/v1/receivings/{asnId}/checkin ⁠ – cria movimento de recebimento.
•⁠  ⁠⁠ POST /api/v1/pickwaves ⁠ – gera ondas com políticas.
•⁠  ⁠⁠ PATCH /api/v1/tasks/{id} ⁠ – confirma tarefa com evidências.
•⁠  ⁠⁠ POST /api/v1/shipments/{id}/pod ⁠ – carrega POD (assinatura/foto/ocr/geotag/hash).
•⁠  ⁠Webhooks: ⁠ inventory.changed ⁠, ⁠ shipment.eta.updated ⁠, ⁠ shipment.pod.captured ⁠ (HMAC + retry).

---

## Dados & Retenção

•⁠  ⁠Eventos operacionais: 36 meses (quente 90 dias / frio 33 meses).
•⁠  ⁠Logs de segurança: ≥ 12 meses (WORM 6 meses).
•⁠  ⁠POD: 5–10 anos (conforme jurídico/contratual).
•⁠  ⁠Telemetria veículo: 12–24 meses (agregado/anonimizado após 90 dias).

---

## Bill of Materials (BoM) de Hardware sugerido

•⁠  ⁠Handhelds Android IP65+, scanners 2D, ring scanners, headsets de voz, óculos AR (opcional).
•⁠  ⁠Balanças, impressoras térmicas (etiquetas GS1), gateways IoT, leitores RFID/UWB, e‑seals.
•⁠  ⁠Access points Wi‑Fi 6/6E, UPS/geradores em armazéns críticos.

---

## Documentos & Artefatos Entregáveis

•⁠  ⁠Políticas ISMS, SoA, BIA, DPIA, Plano DR.
•⁠  ⁠Especificação de processos (BPMN), diagramas C4 e sequência.
•⁠  ⁠Catálogo de APIs, dicionário de dados, mapeamento GS1.
•⁠  ⁠Playbooks de operação (runbooks) e resposta a incidentes.

---

## Checklist de “Melhor que os Melhores” (Go‑Live)

•⁠  ⁠[ ] Precisão de inventário ≥ 99,8% confirmada por contagem cíclica
•⁠  ⁠[ ] Erro de picking ≤ 0,1% em 30 dias
•⁠  ⁠[ ] MAPE de ETA < 12% e média de erro < 7 minutos
•⁠  ⁠[ ] 100% dos PODs com assinatura + foto + geotag + hash imutável
•⁠  ⁠[ ] Sincronização offline validada (≥ 72h sem rede)
•⁠  ⁠[ ] Pentest sem achados críticos, cobertura SAST/DAST/SCA > 90%
•⁠  ⁠[ ] DR testado com RTO ≤ 1h / RPO ≤ 15min

---

## Próximos Passos

 1.⁠ ⁠Confirmar processos atuais e volumes (SKU, linhas/dia, veículos, áreas).
 2.⁠ ⁠Selecionar BoM de hardware e PoC de RTLS.
 3.⁠ ⁠Definir metas por site e cronograma de rollout.
 4.⁠ ⁠Iniciar Fase 0 (fundations) com quick wins em 6 semanas.
