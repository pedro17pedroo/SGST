import React from 'react';
import { useQuery } from '@tanstack/react-query';
import { apiRequest } from '@/lib/queryClient';

interface Warehouse {
  id: string;
  name: string;
  address?: string;
  isActive: boolean;
}

export function TestWarehouses() {
  console.log('ðŸ§ª TestWarehouses component rendered');
  
  const { data: warehouses, isLoading, error } = useQuery<Warehouse[]>({
    queryKey: ['test-warehouses'],
    queryFn: async () => {
      console.log('ðŸ§ª Executando query de teste para armazÃ©ns...');
      const response = await apiRequest('GET', '/api/warehouses');
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}`);
      }
      
      const result = await response.json();
      console.log('ðŸ§ª Resultado da query de teste:', result);
      
      return result.data || result;
    },
    staleTime: 0,
    gcTime: 0,
    retry: false
  });
  
  console.log('ðŸ§ª Estado da query:', { warehouses, isLoading, error });
  
  return (
    <div style={{ padding: '20px', border: '2px solid red', margin: '10px' }}>
      <h3>Teste de ArmazÃ©ns</h3>
      <p>Loading: {isLoading ? 'Sim' : 'NÃ£o'}</p>
      <p>Error: {error ? String(error) : 'Nenhum'}</p>
      <p>Warehouses: {warehouses ? warehouses.length : 0}</p>
      {warehouses && (
        <ul>
          {warehouses.map((w) => (
            <li key={w.id}>{w.name}</li>
          ))}
        </ul>
      )}
    </div>
  );
}